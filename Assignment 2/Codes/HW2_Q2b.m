% Part 1 %
% Floyd-Steinberg%

F=readraw('LightHouse.raw',750,500);
figure(1)
imshow(F);
title('Original Light House Image');
[R, C]=size(F);
G=F;
T=192;

for i=1:R    
    if mod(i,2)~=0
       for j=1:C
           if G(i,j)>T
               b(i,j)=255;
           else
               b(i,j)=0;
           end
           e = G(i,j)-b(i,j);
           if j==1 
               G(i,j+1)=G(i,j+1)+((7/16)*e);
               G(i+1,j)=G(i+1,j)+((5/16)*e);
               G(i+1,j+1)=G(i+1,j+1)+((1/16)*e);
           elseif j==C              
               G(i+1,j-1)=G(i+1,j-1)+((3/16)*e);
               G(i+1,j)=G(i+1,j)+((5/16)*e);
           else 
               G(i,j+1)=G(i,j+1)+((7/16)*e);
               G(i+1,j-1)=G(i+1,j-1)+((3/16)*e);
               G(i+1,j)=G(i+1,j)+((5/16)*e);
               G(i+1,j+1)=G(i+1,j+1)+((1/16)*e);
           end 
       end
    else
        if i~=R
            for j=C:-1:1
                if G(i,j)>T
                    b(i,j)=255;
                else
                    b(i,j)=0;
                end
                e = G(i,j)-b(i,j);
               if j==C
                   G(i,j-1)=G(i,j-1)+((7/16)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((1/16)*e);
                   G(i+1,j)=G(i+1,j)+((5/16)*e);
               elseif j==1
                   G(i+1,j)=G(i+1,j)+((5/16)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((3/16)*e);
               else
                   G(i,j-1)=G(i,j-1)+((7/16)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((1/16)*e);
                   G(i+1,j)=G(i+1,j)+((5/16)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((3/16)*e);                
               end  
            end
        else
            for j=C:-1:1
               if G(i,j)>T
                    b(i,j)=255;
               else
                    b(i,j)=0;
               end
               e = G(i,j)-b(i,j);
               if j~=1
                   G(i,j-1)=G(i,j-1)+((7/16)*e);
               end  
            end
        end
    end
end

figure(2);
imshow(uint8(b));
title('Floyd-Steinberg Error Diffusion');

% Part 2 %
% Jarvis, Judice, and Ninke (JJN) %
b=zeros(R,C);
G=F;
for i=1:R    
    if mod(i,2)~=0
      if i~=(R-1)
       for j=1:C
           if G(i,j)>T
               b(i,j)=255;
           else
               b(i,j)=0;
           end
           e = G(i,j)-b(i,j);
           if j==1
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);
               G(i+2,j)=G(i+2,j)+((5/48)*e);
               G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);
           elseif j==2
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e); 
               G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
               G(i+2,j)=G(i+2,j)+((5/48)*e);
               G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);
           elseif j==C
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);
               G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
               G(i+2,j)=G(i+2,j)+((5/48)*e);
           elseif j==C-1
               G(i,j+1)=G(i,j+1)+((7/48)*e); 
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);
               G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
               G(i+2,j)=G(i+2,j)+((5/48)*e);
               G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);             
           else 
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);              
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);               
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);               
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);               
               G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);              
               G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
               G(i+2,j)=G(i+2,j)+((5/48)*e);
               G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);
           end  
       end
      else
          for j=C:-1:1
               if G(i,j)>T
                    b(i,j)=255;
               else
                    b(i,j)=0;
               end
               e = G(i,j)-b(i,j);
            if j==1 
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);              
            elseif j==2
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);             
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e); 
           elseif j==C              
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
           elseif j==C-1               
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);           
           else 
               G(i,j+1)=G(i,j+1)+((7/48)*e);
               G(i,j+2)=G(i,j+2)+((5/48)*e);               
               G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);               
               G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
               G(i+1,j)=G(i+1,j)+((7/48)*e);
               G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
               G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);
            end
          end
      end
    else
        if i~=R
            for j=C:-1:1
                if G(i,j)>T
                    b(i,j)=255;
                else
                    b(i,j)=0;
                end
                e=G(i,j)-b(i,j);
               if j==C                   
                   G(i,j-2)=G(i,j-2)+((5/48)*e);
                   G(i,j-1)=G(i,j-1)+((7/48)*e);                  
                   G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);                 
                   G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
                   G(i+1,j)=G(i+1,j)+((7/48)*e);                   
                   G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);                  
                   G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
                   G(i+2,j)=G(i+2,j)+((5/48)*e);
               elseif j==C-1   
                   G(i,j-2)=G(i,j-2)+((5/48)*e);                   
                   G(i,j-1)=G(i,j-1)+((7/48)*e);
                   G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);                   
                   G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);
                   G(i+1,j)=G(i+1,j)+((7/48)*e);                   
                   G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);                   
                   G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);                   
                   G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
                   G(i+2,j)=G(i+2,j)+((5/48)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);      
               elseif j==1
                   G(i+1,j)=G(i+1,j)+((7/48)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);
                   G(i+2,j)=G(i+2,j)+((5/48)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);
               elseif j==2
                   G(i,j-1)=G(i,j-1)+((7/48)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);                  
                   G(i+1,j)=G(i+1,j)+((7/48)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);                  
                   G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);
                   G(i+2,j)=G(i+2,j)+((5/48)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);                   
               else                   
                   G(i,j-2)=G(i,j-2)+((5/48)*e);
                   G(i,j-1)=G(i,j-1)+((7/48)*e);                  
                   G(i+1,j-2)=G(i+1,j-2)+((3/48)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((5/48)*e);                   
                   G(i+1,j)=G(i+1,j)+((7/48)*e);                   
                   G(i+1,j+1)=G(i+1,j+1)+((5/48)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((3/48)*e);                   
                   G(i+2,j-2)=G(i+2,j-2)+((1/48)*e);                   
                   G(i+2,j-1)=G(i+2,j-1)+((3/48)*e);                   
                   G(i+2,j)=G(i+2,j)+((5/48)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((3/48)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/48)*e);     
               end 
            end
        else
            for j=C:-1:1
               if G(i,j)>T
                    b(i,j)=255;
               else
                    b(i,j)=0;
               end
               e = G(i,j)-b(i,j);
               if j==2
                   G(i,j-1)=G(i,j-1)+((7/48)*e);
               elseif (j==1)
               else                   
                   G(i,j-2)=G(i,j-2)+((5/48)*e);
                   G(i,j-1)=G(i,j-1)+((7/48)*e);
               end
            end
        end
    end
end

figure(3);
imshow(uint8(b));
title('JJN Error Diffusion');

% Part 3 %
% Stucki %
b=zeros(R,C);
G=F;
for i=1:R    
    if mod(i,2)~=0
      if i~=R-1
       for j=1:C
           if G(i,j)>T 
               b(i,j)=255;
           else
               b(i,j)=0;
           end
           e = G(i,j)-b(i,j);
           if j==1 
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);               
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);               
               G(i+2,j)=G(i+2,j)+((4/42)*e);
               G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);
           elseif j==2
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e); 
               G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
               G(i+2,j)=G(i+2,j)+((4/42)*e);
               G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);
           elseif j==C
               G(i+1,j)=G(i+1,j)+((8/42)*e);              
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
               G(i+2,j)=G(i+2,j)+((4/42)*e);
               G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
               G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);
           elseif j==C-1
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
               G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);
               G(i+2,j)=G(i+2,j)+((4/42)*e);
               G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);             
           else 
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);               
               G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);               
               G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
               G(i+2,j)=G(i+2,j)+((4/42)*e);
               G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
               G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);
           end 
       end
      else
          for j=C:-1:1
               if G(i,j)>T
                    b(i,j)=255;
               else
                    b(i,j)=0;
               end
               e = G(i,j)-b(i,j);
            if j==1 
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);              
            elseif j==2
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e); 
           elseif j==C
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);              
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
           elseif j==C-1               
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);           
           else 
               G(i,j+1)=G(i,j+1)+((8/42)*e);
               G(i,j+2)=G(i,j+2)+((4/42)*e);
               G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
               G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
               G(i+1,j)=G(i+1,j)+((8/42)*e);
               G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
               G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);
            end 
          end
      end
    else
        if i~=R
            for j=C:-1:1
                if G(i,j)>T
                    b(i,j)=255;
                else
                    b(i,j)=0;
                end
                e = G(i,j)-b(i,j);
               if j==C
                   G(i,j-2)=G(i,j-2)+((4/42)*e);
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
                   G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);
                   G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
                   G(i+2,j)=G(i+2,j)+((4/42)*e);
                   G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
                   G(i+1,j)=G(i+1,j)+((8/42)*e);
               elseif j==C-1
                   G(i,j-2)=G(i,j-2)+((4/42)*e);
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
                   G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
                   G(i+1,j)=G(i+1,j)+((8/42)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
                   G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);
                   G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
                   G(i+2,j)=G(i+2,j)+((4/42)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);      
               elseif j==1
                   G(i+1,j)=G(i+1,j)+((8/42)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);
                   G(i+2,j)=G(i+2,j)+((4/42)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);
               elseif j==2
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
                   G(i+1,j)=G(i+1,j)+((8/42)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);
                   G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
                   G(i+2,j)=G(i+2,j)+((4/42)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);                   
               else
                   G(i,j-2)=G(i,j-2)+((4/42)*e);
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
                   G(i+1,j-2)=G(i+1,j-2)+((2/42)*e);
                   G(i+1,j-1)=G(i+1,j-1)+((4/42)*e);
                   G(i+1,j)=G(i+1,j)+((8/42)*e);
                   G(i+1,j+1)=G(i+1,j+1)+((4/42)*e);
                   G(i+1,j+2)=G(i+1,j+2)+((2/42)*e);
                   G(i+2,j-2)=G(i+2,j-2)+((1/42)*e);
                   G(i+2,j-1)=G(i+2,j-1)+((2/42)*e);
                   G(i+2,j)=G(i+2,j)+((4/42)*e);
                   G(i+2,j+1)=G(i+2,j+1)+((2/42)*e);
                   G(i+2,j+2)=G(i+2,j+2)+((1/42)*e);     
               end   
            end
        else
            for j=C:-1:1
               if G(i,j)>T
                    b(i,j)=255;
               else
                    b(i,j)=0;
               end
               e = G(i,j)-b(i,j);
               if j==2
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
               elseif (j==1)
               else
                   G(i,j-2)=G(i,j-2)+((4/42)*e);
                   G(i,j-1)=G(i,j-1)+((8/42)*e);
               end
            end
        end
    end
end

figure(4);
imshow(uint8(b));
title('Stucki Error Diffusion');